<!-- TOC -->

- [作业和参数](#作业和参数)
    - [作业](#作业)
    - [参数](#参数)
    - [常量传递](#常量传递)
    - [转换命名参数](#转换命名参数)
    - [设置变量、获取变量](#设置变量获取变量)
       - [作业中设置变量](#作业中设置变量)

<!-- /TOC -->

# 作业和参数

### 作业

> 一个作业包含一个或多个作业项，这些作业项以某种顺序来执行。作业执行顺序由作业项之间的跳（job hop）和每个作业项的执行结果来决定

案例：创建一个作业，转换1执行从数据库读取表输出到Excel, 转换2执行读取Excel再输出到Excel。

![img](img/作业.png)

![img](img/作业1.png)



![img](img/作业2.png)

![img](img/作业3.png)



### 参数

- **全局参数：**通过当前用户.kettle文件夹的kettle.properties文件来定义，配置后重启生效。
- **局部参数：**通过Set Variables 与 Get Variables 方式来设置和获取，下个转换才能使用。

**参数的使用**：（在SQL中使用变量要**勾选**"**是否替换变量"**）!!!

- %%变量名%%
- ${变量名}



全局参数案例：配置kettle.properties， 新增全局变量sys_version，读取表并打印版本号和表信息在控制台。

![img](img/全局参数.png)

![img](img/全局参数1.png)





### 常量传递

> 常量传递就是先自定义常量数据，在**表输入**的SQL语句中使用**?**来替换，替换顺序就是常量定义的顺序

案例：读取test_user,其中id值读取配置的常量

![img](img/常量传递.png)

![img](img/常量传递1.png)

![img](img/常量传递2.png)

![img](img/常量传递3.png)





### 转换命名参数

> 转换命名参数指的是转换内部的变量设置，作用范围只存在于转换内部，空白处右键设置

案例：读取test_user,其中id值读取转换命名参数的值

![img](img/转换命名参数.png)

![img](img/转换命名参数1.png)



![img](img/转换命名参数2.png)



### 设置变量、获取变量

案例：创建一个作业，在转换1中读取部门id并设置变量，转换2中获取设置的变量，并查询部门信息输出到Excel。

![img](img/设置变量.png)

转换：

![img](img/设置变量1.png)

![img](img/设置变量2.png)

转换2：

![img](img/设置变量3.png)

![img](img/设置变量4.png)



![img](img/设置变量5.png)



### 作业中设置变量

![img](img/作业设置变量.png)

转换：

![img](img/作业设置变量2.png)

![img](img/作业设置变量3.png)